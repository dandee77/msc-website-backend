<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MSC Backend API Tester - Complete</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f8f9fa;
      }

      .header {
        text-align: center;
        margin-bottom: 30px;
        padding: 20px;
        background: linear-gradient(135deg, #007bff, #0056b3);
        color: white;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .container {
        margin: 20px 0;
        padding: 25px;
        border: 1px solid #ddd;
        border-radius: 10px;
        background: white;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .section-header {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 2px solid #eee;
      }

      .section-icon {
        font-size: 24px;
        margin-right: 10px;
      }

      .success {
        background-color: #d4edda;
        border-color: #c3e6cb;
        color: #155724;
      }
      .error {
        background-color: #f8d7da;
        border-color: #f5c6cb;
        color: #721c24;
      }
      .info {
        background-color: #d1ecf1;
        border-color: #bee5eb;
        color: #0c5460;
      }
      .warning {
        background-color: #fff3cd;
        border-color: #ffeaa7;
        color: #856404;
      }

      .button-group {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin: 15px 0;
      }

      button {
        background: #007bff;
        color: black;
        padding: 12px 20px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s ease;
        min-width: 120px;
      }
      button:hover {
        background: #0056b3;
        transform: translateY(-1px);
      }
      button.secondary {
        background: #6c757d;
      }
      button.secondary:hover {
        background: #545b62;
      }
      button.success {
        background: #28a745;
      }
      button.success:hover {
        background: #218838;
      }
      button.danger {
        background: #dc3545;
      }
      button.danger:hover {
        background: #c82333;
      }

      .form-row {
        display: flex;
        gap: 15px;
        margin: 10px 0;
        flex-wrap: wrap;
      }

      .form-group {
        flex: 1;
        min-width: 200px;
      }

      .form-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: 600;
        color: #495057;
      }

      input,
      textarea,
      select {
        width: 100%;
        padding: 10px;
        margin: 5px 0;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 14px;
        box-sizing: border-box;
      }

      input:focus,
      textarea:focus,
      select:focus {
        outline: none;
        border-color: #007bff;
        box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
      }

      pre {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        overflow-x: auto;
        font-size: 12px;
        line-height: 1.4;
        max-height: 400px;
        border: 1px solid #e9ecef;
      }

      .status-badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        margin-left: 10px;
      }

      .status-ok {
        background: #d4edda;
        color: #155724;
      }

      .status-error {
        background: #f8d7da;
        color: #721c24;
      }

      .tabs {
        display: flex;
        border-bottom: 2px solid #ddd;
        margin-bottom: 20px;
      }

      .tab {
        padding: 12px 20px;
        cursor: pointer;
        border: none;
        background: #f8f9fa;
        border-radius: 8px 8px 0 0;
        margin-right: 5px;
        transition: all 0.3s ease;
      }

      .tab.active {
        background: #007bff;
        color: white;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      .quick-actions {
        position: sticky;
        top: 20px;
        background: white;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
        z-index: 100;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <div class="header">
      <h1>üöÄ MSC Student Portal - Complete Backend API Tester</h1>
      <p>Comprehensive testing tool for all API endpoints</p>
      <div id="connectionStatus" class="status-badge status-error">
        Not Connected
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <h4>üéØ Quick Actions</h4>
      <div class="button-group">
        <button onclick="testConnection()">üîå Test Connection</button>
        <button onclick="showAllTabs()">üìã Show All Sections</button>
        <button onclick="clearAllResults()">üóëÔ∏è Clear All Results</button>
        <button onclick="exportResults()" class="secondary">
          üìÑ Export Results
        </button>
      </div>
    </div>

    <!-- Tab Navigation -->
    <div class="tabs">
      <button class="tab active" onclick="showTab('auth')">
        üîê Authentication
      </button>
      <button class="tab" onclick="showTab('students')">üë• Students</button>
      <button class="tab" onclick="showTab('events')">üìÖ Events</button>
      <button class="tab" onclick="showTab('announcements')">
        üì¢ Announcements
      </button>
      <button class="tab" onclick="showTab('dashboard')">üìä Dashboard</button>
      <button class="tab" onclick="showTab('system')">‚öôÔ∏è System</button>
    </div>

    <!-- Authentication Tab -->
    <div id="auth" class="tab-content active">
      <div class="container">
        <div class="section-header">
          <span class="section-icon">üîê</span>
          <h2>Authentication Endpoints</h2>
        </div>

        <h3>Login</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Username or Email</label>
            <input
              type="text"
              id="loginUsername"
              placeholder="Username or Email"
              value=""
            />
          </div>
          <div class="form-group">
            <label>Password</label>
            <input
              type="password"
              id="loginPassword"
              placeholder="Password"
              value=""
            />
          </div>
        </div>
        <div class="button-group">
          <button onclick="testLogin()">üîë Login</button>
        </div>

        <h3>Register New User</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Username</label>
            <input
              type="text"
              id="regUsername"
              placeholder="Username"
              value="newuser"
            />
          </div>
          <div class="form-group">
            <label>Email</label>
            <input
              type="email"
              id="regEmail"
              placeholder="Email"
              value="newuser@example.com"
            />
          </div>
          <div class="form-group">
            <label>Password</label>
            <input
              type="password"
              id="regPassword"
              placeholder="Password"
              value="Password_123"
            />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>First Name</label>
            <input
              type="text"
              id="regFirstName"
              placeholder="First Name"
              value="John"
            />
          </div>
          <div class="form-group">
            <label>Middle Name</label>
            <input
              type="text"
              id="regMiddleName"
              placeholder="Middle Name"
              value="M"
            />
          </div>
          <div class="form-group">
            <label>Last Name</label>
            <input
              type="text"
              id="regLastName"
              placeholder="Last Name"
              value="Doe"
            />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Student Number</label>
            <input
              type="text"
              id="regStudentNo"
              placeholder="Student Number"
              value="2021-12345"
            />
          </div>
          <div class="form-group">
            <label>Year Level</label>
            <input
              type="text"
              id="regYearLevel"
              placeholder="Year Level"
              value="4th Year"
            />
          </div>
          <div class="form-group">
            <label>Gender</label>
            <select id="regGender">
              <option value="Male">Male</option>
              <option value="Female">Female</option>
              <option value="Other">Other</option>
            </select>
          </div>
          <div class="form-group">
            <label>Role</label>
            <select id="regRole">
              <option value="member">Member</option>
              <option value="officer">Officer</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>College</label>
            <input
              type="text"
              id="regCollege"
              placeholder="College"
              value="College of Engineering"
            />
          </div>
          <div class="form-group">
            <label>Program</label>
            <input
              type="text"
              id="regProgram"
              placeholder="Program"
              value="Computer Science"
            />
          </div>
          <div class="form-group">
            <label>Birthdate</label>
            <input type="date" id="regBirthdate" value="2000-01-01" />
          </div>
        </div>
        <div class="button-group">
          <button onclick="testRegister()" class="success">
            üìù Register User
          </button>
          <button onclick="fillRandomData()" class="secondary">
            üé≤ Fill Random Data
          </button>
        </div>

        <h3>Profile & Account Management</h3>
        <div class="button-group">
          <button onclick="testGetProfile()">üë§ Get My Profile</button>
          <button onclick="testForgotPassword()" class="warning">
            üîì Forgot Password
          </button>
          <button onclick="testLogout()" class="danger">üö™ Logout</button>
        </div>

        <h3>Change Password</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Current Password</label>
            <input
              type="password"
              id="currentPassword"
              placeholder="Current Password"
            />
          </div>
          <div class="form-group">
            <label>New Password</label>
            <input
              type="password"
              id="newPassword"
              placeholder="New Password"
            />
          </div>
        </div>
        <div class="button-group">
          <button onclick="testChangePassword()">üîÑ Change Password</button>
        </div>
      </div>
    </div>

    <!-- Students Tab -->
    <div id="students" class="tab-content">
      <div class="container">
        <div class="section-header">
          <span class="section-icon">üë•</span>
          <h2>Student Management</h2>
        </div>

        <h3>Get Students</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Page</label>
            <input type="number" id="studentsPage" value="1" min="1" />
          </div>
          <div class="form-group">
            <label>Limit</label>
            <input
              type="number"
              id="studentsLimit"
              value="20"
              min="1"
              max="100"
            />
          </div>
          <div class="form-group">
            <label>Role Filter</label>
            <select id="studentsRole">
              <option value="">All Roles</option>
              <option value="member">Members Only</option>
              <option value="officer">Officers Only</option>
            </select>
          </div>
        </div>
        <div class="button-group">
          <button onclick="testGetAllStudents()">üìã Get All Students</button>
          <button onclick="testGetDashboardData()">
            üìä Get Dashboard Data
          </button>
          <button onclick="testSearchStudents()">üîç Search Students</button>
        </div>

        <h3>Student Operations</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Student ID</label>
            <input
              type="number"
              id="studentId"
              placeholder="Enter Student ID"
              value="1"
            />
          </div>
        </div>
        <div class="button-group">
          <button onclick="testGetStudentById()">üë§ Get Student by ID</button>
          <button onclick="testToggleStudentActive()" class="warning">
            üîÑ Toggle Active Status
          </button>
        </div>

        <h3>Search Students</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Search Query</label>
            <input
              type="text"
              id="searchQuery"
              placeholder="Search by name, email, student number..."
              value="john"
            />
          </div>
        </div>
        <div class="button-group">
          <button onclick="testSearchStudents()">üîç Search Students</button>
        </div>
      </div>
    </div>

    <!-- Events Tab -->
    <div id="events" class="tab-content">
      <div class="container">
        <div class="section-header">
          <span class="section-icon">üìÖ</span>
          <h2>Event Management</h2>
        </div>

        <h3>Get Events</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Page</label>
            <input type="number" id="eventsPage" value="1" min="1" />
          </div>
          <div class="form-group">
            <label>Limit</label>
            <input type="number" id="eventsLimit" value="10" min="1" max="50" />
          </div>
          <div class="form-group">
            <label>Status Filter</label>
            <select id="eventsStatus">
              <option value="">All Events</option>
              <option value="upcoming">Upcoming</option>
              <option value="completed">Completed</option>
              <option value="canceled">Canceled</option>
            </select>
          </div>
        </div>
        <div class="button-group">
          <button onclick="testGetAllEvents()">üìã Get All Events</button>
          <button onclick="testGetUpcomingEvents()">üîú Upcoming Events</button>
          <button onclick="testGetCalendarEvents()">üìÖ Calendar Events</button>
        </div>

        <h3>Event Operations</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Event ID</label>
            <input
              type="number"
              id="eventId"
              placeholder="Enter Event ID"
              value="1"
            />
          </div>
        </div>
        <div class="button-group">
          <button onclick="testGetEventById()">üéØ Get Event by ID</button>
          <button onclick="testRegisterForEvent()" class="success">
            ‚úÖ Register for Event
          </button>
          <button onclick="testGetEventRegistrations()">
            üë• Get Registrations
          </button>
          <button onclick="testDeleteEvent()" class="danger">
            üóëÔ∏è Delete Event
          </button>
        </div>

        <h3>Create New Event</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Event Name</label>
            <input
              type="text"
              id="eventName"
              placeholder="Event Name"
              value="Test Event"
            />
          </div>
          <div class="form-group">
            <label>Event Date</label>
            <input type="date" id="eventDate" value="2025-12-25" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Start Time</label>
            <input type="time" id="eventTimeStart" value="10:00" />
          </div>
          <div class="form-group">
            <label>End Time</label>
            <input type="time" id="eventTimeEnd" value="12:00" />
          </div>
          <div class="form-group">
            <label>Event Type</label>
            <select id="eventType">
              <option value="onsite">Onsite</option>
              <option value="online">Online</option>
              <option value="hybrid">Hybrid</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Location</label>
            <input
              type="text"
              id="eventLocation"
              placeholder="Location"
              value="Main Hall"
            />
          </div>
          <div class="form-group">
            <label>Event Restriction</label>
            <select id="eventRestriction">
              <option value="public">Public</option>
              <option value="members">Members Only</option>
              <option value="officers">Officers Only</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Description</label>
            <textarea
              id="eventDescription"
              placeholder="Event Description"
              rows="3"
            >
This is a test event</textarea
            >
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>
              <input type="checkbox" id="eventRegistrationRequired" checked />
              Registration Required
            </label>
          </div>
        </div>
        <div class="button-group">
          <button onclick="testCreateEvent()" class="success">
            ‚ûï Create Event
          </button>
          <button onclick="fillEventDefaults()" class="secondary">
            üé≤ Fill Default Data
          </button>
        </div>

        <h3>Update Event</h3>
        <div class="button-group">
          <button onclick="testUpdateEvent()" class="warning">
            ‚úèÔ∏è Update Event
          </button>
        </div>

        <h3>Attendance Management</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Event ID</label>
            <input
              type="number"
              id="attendanceEventId"
              placeholder="Event ID"
              value="1"
            />
          </div>
          <div class="form-group">
            <label>Student ID</label>
            <input
              type="number"
              id="attendanceStudentId"
              placeholder="Student ID"
              value="1"
            />
          </div>
          <div class="form-group">
            <label>Status</label>
            <select id="attendanceStatus">
              <option value="registered">Registered</option>
              <option value="attended">Attended</option>
              <option value="absent">Absent</option>
            </select>
          </div>
        </div>
        <div class="button-group">
          <button onclick="testUpdateAttendance()" class="warning">
            ‚úèÔ∏è Update Attendance
          </button>
        </div>
      </div>
    </div>

    <!-- Announcements Tab -->
    <div id="announcements" class="tab-content">
      <div class="container">
        <div class="section-header">
          <span class="section-icon">üì¢</span>
          <h2>Announcement Management</h2>
        </div>

        <h3>Get Announcements</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Page</label>
            <input type="number" id="announcementsPage" value="1" min="1" />
          </div>
          <div class="form-group">
            <label>Limit</label>
            <input
              type="number"
              id="announcementsLimit"
              value="10"
              min="1"
              max="50"
            />
          </div>
          <div class="form-group">
            <label>Include Archived</label>
            <select id="includeArchived">
              <option value="false">Active Only</option>
              <option value="true">Include Archived</option>
            </select>
          </div>
        </div>
        <div class="button-group">
          <button onclick="testGetAllAnnouncements()">
            üìã Get All Announcements
          </button>
          <button onclick="testGetRecentAnnouncements()">
            üî• Recent Announcements
          </button>
        </div>

        <h3>Announcement Operations</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Announcement ID</label>
            <input
              type="number"
              id="announcementId"
              placeholder="Enter Announcement ID"
              value="1"
            />
          </div>
        </div>
        <div class="button-group">
          <button onclick="testGetAnnouncementById()">üéØ Get by ID</button>
          <button onclick="testArchiveAnnouncement()" class="warning">
            üì¶ Archive
          </button>
          <button onclick="testUnarchiveAnnouncement()" class="warning">
            üì§ Unarchive
          </button>
          <button onclick="testDeleteAnnouncement()" class="danger">
            üóëÔ∏è Delete
          </button>
        </div>

        <h3>Create New Announcement</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Title</label>
            <input
              type="text"
              id="announcementTitle"
              placeholder="Announcement Title"
              value="Test Announcement"
            />
          </div>
          <div class="form-group">
            <label>Posted By</label>
            <input
              type="text"
              id="announcementPostedBy"
              placeholder="Posted By"
              value="Admin"
            />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Content</label>
            <textarea
              id="announcementContent"
              placeholder="Announcement Content"
              rows="4"
            >
This is a test announcement content.</textarea
            >
          </div>
        </div>
        <div class="button-group">
          <button onclick="testCreateAnnouncement()" class="success">
            ‚ûï Create Announcement
          </button>
          <button onclick="fillAnnouncementDefaults()" class="secondary">
            üé≤ Fill Default Data
          </button>
        </div>

        <h3>Update Announcement</h3>
        <div class="button-group">
          <button onclick="testUpdateAnnouncement()" class="warning">
            ‚úèÔ∏è Update Announcement
          </button>
        </div>

        <h3>Search Announcements</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Search Query</label>
            <input
              type="text"
              id="announcementSearchQuery"
              placeholder="Search announcements..."
              value="test"
            />
          </div>
        </div>
        <div class="button-group">
          <button onclick="testSearchAnnouncements()">
            üîç Search Announcements
          </button>
        </div>
      </div>
    </div>

    <!-- Dashboard Tab -->
    <div id="dashboard" class="tab-content">
      <div class="container">
        <div class="section-header">
          <span class="section-icon">üìä</span>
          <h2>Dashboard & Analytics</h2>
        </div>

        <h3>Dashboard Data</h3>
        <div class="button-group">
          <button onclick="testGetDashboardData()">
            üìä Get Dashboard Stats
          </button>
          <button onclick="testGetRecentAnnouncements()">
            üì¢ Recent Announcements
          </button>
          <button onclick="testGetUpcomingEvents()">ÔøΩ Upcoming Events</button>
        </div>

        <h3>System Information</h3>
        <div class="button-group">
          <button onclick="testHealthCheck()">‚ù§Ô∏è Health Check</button>
          <button onclick="testAPIInfo()">‚ÑπÔ∏è API Information</button>
        </div>
      </div>
    </div>

    <!-- System Tab -->
    <div id="system" class="tab-content">
      <div class="container">
        <div class="section-header">
          <span class="section-icon">‚öôÔ∏è</span>
          <h2>System Testing & Utilities</h2>
        </div>

        <h3>Connection Tests</h3>
        <div class="button-group">
          <button onclick="testConnection()">üîå Test API Connection</button>
          <button onclick="testAllEndpoints()" class="warning">
            üß™ Test All Auth Endpoints
          </button>
        </div>

        <h3>Data Management</h3>
        <div class="button-group">
          <button onclick="generateTestData()" class="success">
            üé≤ Generate Test Data
          </button>
          <button onclick="clearTestResults()" class="danger">
            üóëÔ∏è Clear All Results
          </button>
        </div>

        <h3>Bulk Operations</h3>
        <div class="button-group">
          <button onclick="runFullSystemTest()" class="warning">
            üöÄ Full System Test
          </button>
          <button onclick="testPerformance()" class="secondary">
            ‚ö° Performance Test
          </button>
        </div>
      </div>
    </div>

    <!-- Response Section -->
    <div class="container">
      <div class="section-header">
        <span class="section-icon">üìã</span>
        <h2>API Response & Results</h2>
      </div>
      <div id="response">
        No tests run yet. Select a tab above and click any test button to see
        results here.
      </div>
    </div>

    <script>
      // Configuration
      const API_BASE = "/msc-website-backend-main/api";
      let testResults = [];
      let currentUser = null;

      // Initialize the tester
      document.addEventListener("DOMContentLoaded", function () {
        testConnection();
        updateConnectionStatus();
      });

      // Utility Functions
      function updateConnectionStatus() {
        const statusEl = document.getElementById("connectionStatus");
        fetch(`${API_BASE}/`)
          .then((response) => response.json())
          .then((data) => {
            if (data.success) {
              statusEl.textContent = "Connected ‚úÖ";
              statusEl.className = "status-badge status-ok";
            }
          })
          .catch(() => {
            statusEl.textContent = "Disconnected ‚ùå";
            statusEl.className = "status-badge status-error";
          });
      }

      function displayResponse(data, isError = false, title = "") {
        const responseDiv = document.getElementById("response");
        const timestamp = new Date().toLocaleTimeString();

        responseDiv.className = `container ${isError ? "error" : "success"}`;
        responseDiv.innerHTML = `
          <h4>${
            title || (isError ? "‚ùå Error Response" : "‚úÖ Success Response")
          } - ${timestamp}</h4>
          <pre>${JSON.stringify(data, null, 2)}</pre>
        `;

        // Store result
        testResults.push({
          timestamp: new Date().toISOString(),
          title: title,
          success: !isError,
          data: data,
        });

        // Scroll to response
        responseDiv.scrollIntoView({ behavior: "smooth" });
      }

      async function apiCall(
        endpoint,
        method = "GET",
        data = null,
        title = ""
      ) {
        try {
          const options = {
            method: method,
            headers: {
              "Content-Type": "application/json",
            },
            credentials: "include",
          };

          if (data) {
            options.body = JSON.stringify(data);
          }

          console.log(`üöÄ ${method} ${endpoint}:`, data);

          const response = await fetch(`${API_BASE}${endpoint}`, options);
          const result = await response.json();

          displayResponse(
            {
              status: response.status,
              statusText: response.statusText,
              url: `${API_BASE}${endpoint}`,
              method: method,
              data: result,
            },
            !response.ok,
            title || `${method} ${endpoint}`
          );

          return result;
        } catch (error) {
          console.error("API Error:", error);
          displayResponse(
            {
              error: error.message,
              endpoint: endpoint,
              method: method,
            },
            true,
            `‚ùå ${method} ${endpoint} - Network Error`
          );
          return null;
        }
      }

      // Tab Management
      function showTab(tabName) {
        // Hide all tab contents
        const tabContents = document.querySelectorAll(".tab-content");
        tabContents.forEach((tab) => tab.classList.remove("active"));

        // Remove active class from all tabs
        const tabs = document.querySelectorAll(".tab");
        tabs.forEach((tab) => tab.classList.remove("active"));

        // Show selected tab content
        document.getElementById(tabName).classList.add("active");

        // Add active class to clicked tab
        event.target.classList.add("active");
      }

      function showAllTabs() {
        const tabContents = document.querySelectorAll(".tab-content");
        tabContents.forEach((tab) => tab.classList.add("active"));
      }

      // Authentication Functions
      async function testLogin() {
        const username = document.getElementById("loginUsername").value;
        const password = document.getElementById("loginPassword").value;

        const result = await apiCall(
          "/auth/login",
          "POST",
          {
            username: username,
            password: password,
          },
          "üîë User Login"
        );

        if (result && result.success) {
          currentUser = result.user || result.data;
        }
      }

      async function testLoginWithEmail() {
        document.getElementById("loginUsername").value = "test@example.com";
        await testLogin();
      }

      async function testRegister() {
        const data = {
          username: document.getElementById("regUsername").value,
          email: document.getElementById("regEmail").value,
          password: document.getElementById("regPassword").value,
          first_name: document.getElementById("regFirstName").value,
          middle_name: document.getElementById("regMiddleName").value,
          last_name: document.getElementById("regLastName").value,
          birthdate: document.getElementById("regBirthdate").value,
          gender: document.getElementById("regGender").value,
          role: document.getElementById("regRole").value,
          student_no: document.getElementById("regStudentNo").value,
          year_level: document.getElementById("regYearLevel").value,
          college: document.getElementById("regCollege").value,
          program: document.getElementById("regProgram").value,
        };

        await apiCall("/auth/register", "POST", data, "üìù User Registration");
      }

      async function testGetProfile() {
        await apiCall("/auth/profile", "GET", null, "üë§ Get User Profile");
      }

      async function testChangePassword() {
        const data = {
          current_password: document.getElementById("currentPassword").value,
          new_password: document.getElementById("newPassword").value,
        };

        await apiCall(
          "/auth/change-password",
          "POST",
          data,
          "üîÑ Change Password"
        );
      }

      async function testForgotPassword() {
        const email = document.getElementById("regEmail").value;
        await apiCall(
          "/auth/forgot-password",
          "POST",
          { email: email },
          "üîì Forgot Password"
        );
      }

      async function testLogout() {
        const result = await apiCall(
          "/auth/logout",
          "POST",
          null,
          "üö™ User Logout"
        );
        if (result && result.success) {
          currentUser = null;
        }
      }

      // Student Functions
      async function testGetAllStudents() {
        const page = document.getElementById("studentsPage").value;
        const limit = document.getElementById("studentsLimit").value;
        const role = document.getElementById("studentsRole").value;

        let queryParams = `?page=${page}&limit=${limit}`;
        if (role) queryParams += `&role=${role}`;

        await apiCall(
          `/students${queryParams}`,
          "GET",
          null,
          "üë• Get All Students"
        );
      }

      async function testGetStudentById() {
        const id = document.getElementById("studentId").value;
        await apiCall(`/students/${id}`, "GET", null, `üë§ Get Student #${id}`);
      }

      async function testGetDashboardData() {
        await apiCall("/students/dashboard", "GET", null, "üìä Dashboard Data");
      }

      async function testSearchStudents() {
        const query = document.getElementById("searchQuery").value;
        await apiCall(
          `/students/search?q=${encodeURIComponent(query)}`,
          "GET",
          null,
          "üîç Search Students"
        );
      }

      async function testToggleStudentActive() {
        const id = document.getElementById("studentId").value;
        await apiCall(
          `/students/${id}/toggle-active`,
          "POST",
          null,
          `üîÑ Toggle Student #${id} Active`
        );
      }

      // Event Functions
      async function testGetAllEvents() {
        const page = document.getElementById("eventsPage").value;
        const limit = document.getElementById("eventsLimit").value;
        const status = document.getElementById("eventsStatus").value;

        let queryParams = `?page=${page}&limit=${limit}`;
        if (status) queryParams += `&status=${status}`;

        await apiCall(
          `/events${queryParams}`,
          "GET",
          null,
          "üìÖ Get All Events"
        );
      }

      async function testGetEventById() {
        const id = document.getElementById("eventId").value;
        await apiCall(`/events/${id}`, "GET", null, `üéØ Get Event #${id}`);
      }

      async function testGetUpcomingEvents() {
        await apiCall("/events/upcoming", "GET", null, "üîú Upcoming Events");
      }

      async function testGetCalendarEvents() {
        await apiCall("/events/calendar", "GET", null, "üìÖ Calendar Events");
      }

      async function testCreateEvent() {
        const data = {
          event_name: document.getElementById("eventName").value,
          event_date: document.getElementById("eventDate").value,
          event_time_start: document.getElementById("eventTimeStart").value,
          event_time_end: document.getElementById("eventTimeEnd").value,
          location: document.getElementById("eventLocation").value,
          description: document.getElementById("eventDescription").value,
          event_type: document.getElementById("eventType").value,
          event_restriction: document.getElementById("eventRestriction").value,
          registration_required: document.getElementById(
            "eventRegistrationRequired"
          ).checked,
        };

        await apiCall("/events", "POST", data, "‚ûï Create Event");
      }

      async function testUpdateEvent() {
        const id = document.getElementById("eventId").value;
        const data = {
          event_name: document.getElementById("eventName").value,
          event_date: document.getElementById("eventDate").value,
          event_time_start: document.getElementById("eventTimeStart").value,
          event_time_end: document.getElementById("eventTimeEnd").value,
          location: document.getElementById("eventLocation").value,
          description: document.getElementById("eventDescription").value,
          event_type: document.getElementById("eventType").value,
        };

        await apiCall(`/events/${id}`, "PUT", data, `‚úèÔ∏è Update Event #${id}`);
      }

      async function testDeleteEvent() {
        const id = document.getElementById("eventId").value;
        if (confirm(`Are you sure you want to delete event #${id}?`)) {
          await apiCall(
            `/events/${id}`,
            "DELETE",
            null,
            `üóëÔ∏è Delete Event #${id}`
          );
        }
      }

      async function testRegisterForEvent() {
        const id = document.getElementById("eventId").value;
        await apiCall(
          `/events/${id}/register`,
          "POST",
          null,
          `‚úÖ Register for Event #${id}`
        );
      }

      async function testGetEventRegistrations() {
        const id = document.getElementById("eventId").value;
        await apiCall(
          `/events/${id}/registrations`,
          "GET",
          null,
          `üë• Event #${id} Registrations`
        );
      }

      async function testUpdateAttendance() {
        const eventId = document.getElementById("attendanceEventId").value;
        const studentId = document.getElementById("attendanceStudentId").value;
        const status = document.getElementById("attendanceStatus").value;

        await apiCall(
          `/events/${eventId}/attendance/${studentId}`,
          "PUT",
          { attendance_status: status },
          `‚úèÔ∏è Update Attendance: Event #${eventId}, Student #${studentId}`
        );
      }

      // Announcement Functions
      async function testGetAllAnnouncements() {
        const page = document.getElementById("announcementsPage").value;
        const limit = document.getElementById("announcementsLimit").value;
        const includeArchived =
          document.getElementById("includeArchived").value;

        let queryParams = `?page=${page}&limit=${limit}&include_archived=${includeArchived}`;

        await apiCall(
          `/announcements${queryParams}`,
          "GET",
          null,
          "üì¢ Get All Announcements"
        );
      }

      async function testGetAnnouncementById() {
        const id = document.getElementById("announcementId").value;
        await apiCall(
          `/announcements/${id}`,
          "GET",
          null,
          `üéØ Get Announcement #${id}`
        );
      }

      async function testGetRecentAnnouncements() {
        await apiCall(
          "/announcements/recent",
          "GET",
          null,
          "üî• Recent Announcements"
        );
      }

      async function testCreateAnnouncement() {
        const data = {
          title: document.getElementById("announcementTitle").value,
          content: document.getElementById("announcementContent").value,
          posted_by: document.getElementById("announcementPostedBy").value,
        };

        await apiCall("/announcements", "POST", data, "‚ûï Create Announcement");
      }

      async function testUpdateAnnouncement() {
        const id = document.getElementById("announcementId").value;
        const data = {
          title: document.getElementById("announcementTitle").value,
          content: document.getElementById("announcementContent").value,
          posted_by: document.getElementById("announcementPostedBy").value,
        };

        await apiCall(
          `/announcements/${id}`,
          "PUT",
          data,
          `‚úèÔ∏è Update Announcement #${id}`
        );
      }

      async function testArchiveAnnouncement() {
        const id = document.getElementById("announcementId").value;
        await apiCall(
          `/announcements/${id}/archive`,
          "POST",
          null,
          `üì¶ Archive Announcement #${id}`
        );
      }

      async function testUnarchiveAnnouncement() {
        const id = document.getElementById("announcementId").value;
        await apiCall(
          `/announcements/${id}/unarchive`,
          "POST",
          null,
          `üì§ Unarchive Announcement #${id}`
        );
      }

      async function testDeleteAnnouncement() {
        const id = document.getElementById("announcementId").value;
        if (confirm(`Are you sure you want to delete announcement #${id}?`)) {
          await apiCall(
            `/announcements/${id}`,
            "DELETE",
            null,
            `üóëÔ∏è Delete Announcement #${id}`
          );
        }
      }

      async function testSearchAnnouncements() {
        const query = document.getElementById("announcementSearchQuery").value;
        await apiCall(
          `/announcements/search?q=${encodeURIComponent(query)}`,
          "GET",
          null,
          "üîç Search Announcements"
        );
      }

      // System Functions
      async function testConnection() {
        await apiCall("/", "GET", null, "üîå API Connection Test");
        updateConnectionStatus();
      }

      async function testHealthCheck() {
        await apiCall("/health", "GET", null, "‚ù§Ô∏è Health Check");
      }

      async function testAPIInfo() {
        await apiCall("/", "GET", null, "‚ÑπÔ∏è API Information");
      }

      // Utility Functions
      function fillRandomData() {
        const randomNum = Math.floor(Math.random() * 1000);
        document.getElementById("regUsername").value = `user${randomNum}`;
        document.getElementById(
          "regEmail"
        ).value = `user${randomNum}@example.com`;
        document.getElementById("regFirstName").value = "Test";
        document.getElementById("regLastName").value = `User${randomNum}`;
        document.getElementById("regStudentNo").value = `2021-${
          10000 + randomNum
        }`;
      }

      function fillEventDefaults() {
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        document.getElementById("eventDate").value = tomorrow
          .toISOString()
          .split("T")[0];
        document.getElementById("eventName").value = `Test Event ${Math.floor(
          Math.random() * 100
        )}`;
      }

      function fillAnnouncementDefaults() {
        const num = Math.floor(Math.random() * 100);
        document.getElementById(
          "announcementTitle"
        ).value = `Test Announcement ${num}`;
        document.getElementById(
          "announcementContent"
        ).value = `This is test announcement content number ${num}.`;
      }

      function clearAllResults() {
        testResults = [];
        document.getElementById("response").innerHTML = "All results cleared.";
      }

      function exportResults() {
        const data = JSON.stringify(testResults, null, 2);
        const blob = new Blob([data], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `msc-api-test-results-${
          new Date().toISOString().split("T")[0]
        }.json`;
        a.click();
      }

      // Advanced Testing Functions
      async function testAllEndpoints() {
        displayResponse(
          { message: "Starting comprehensive endpoint test..." },
          false,
          "üß™ Starting Full Test"
        );

        await testConnection();
        await new Promise((r) => setTimeout(r, 500));

        // Test auth endpoints
        await apiCall("/auth", "GET", null, "Auth Endpoints Info");
        await new Promise((r) => setTimeout(r, 500));

        displayResponse(
          { message: "Endpoint test completed!" },
          false,
          "‚úÖ Test Complete"
        );
      }

      async function runFullSystemTest() {
        displayResponse(
          { message: "Starting full system test..." },
          false,
          "üöÄ System Test Started"
        );

        const tests = [
          () => testConnection(),
          () => testAPIInfo(),
          () => testHealthCheck(),
          () => apiCall("/auth", "GET", null, "Auth Info"),
          () => testGetAllEvents(),
          () => testGetAllAnnouncements(),
        ];

        for (let i = 0; i < tests.length; i++) {
          await tests[i]();
          await new Promise((r) => setTimeout(r, 1000));
        }

        displayResponse(
          {
            message: "Full system test completed!",
            tests_run: tests.length,
            timestamp: new Date().toISOString(),
          },
          false,
          "‚úÖ Full System Test Complete"
        );
      }

      async function testPerformance() {
        const startTime = performance.now();

        displayResponse(
          { message: "Starting performance test..." },
          false,
          "‚ö° Performance Test"
        );

        const promises = [];
        for (let i = 0; i < 5; i++) {
          promises.push(fetch(`${API_BASE}/`));
        }

        await Promise.all(promises);

        const endTime = performance.now();
        const duration = endTime - startTime;

        displayResponse(
          {
            test: "Concurrent API calls",
            requests: 5,
            duration_ms: Math.round(duration),
            avg_per_request: Math.round(duration / 5),
          },
          false,
          "‚ö° Performance Test Results"
        );
      }

      function generateTestData() {
        fillRandomData();
        fillEventDefaults();
        fillAnnouncementDefaults();
        displayResponse(
          { message: "Test data generated in all forms!" },
          false,
          "üé≤ Test Data Generated"
        );
      }
    </script>
  </body>
</html>
